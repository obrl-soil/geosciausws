# calc raster::origin for GA products
options(digits = 22)
# formula adapted from https://github.com/rspatial/raster/blob/master/R/origin.R
orig <- function(xmin = NULL, ymin = NULL, xmax = NULL, ymax = NULL,
                 cell_x = NULL, cell_y = NULL) {
  e <- c('xmin' = xmin, 'ymin' = ymin, 'xmax' = xmax,'ymax' = ymax)

  r <- abs(c(cell_x, cell_y))

  x <- e['xmin'] - r[1]*(round(e['xmin'] / r[1]))
  y <- e['ymax'] - r[2]*(round(e['ymax'] / r[2]))

  if (isTRUE(all.equal((r[1] + x), abs(x)))) {
    x <- abs(x)
  }
  if (isTRUE(all.equal((r[2] + y), abs(y)))) {
    y <- abs(y)
  }
  return(c(x, y))
}

# SRTM_DEM 1"
orig(112.99986111400005, -44.0001389004617, 153.99986111335099, -10.00013890099995,
     0.00027777777777338031 , -0.00027777777777338031)

# SRTM DEMH 1"
orig(112.99986111100009, -44.000138889548303, 153.9998611116614, -10.000138888999906,
     0.00027777777778225824, -0.00027777777778225813)

# DEM_SRTM_1Second_over_Bathymetry_Topography_1
orig(91.997360943325319, -60.002824466238778, 171.99763936110531, -8.0022684946787805,
     0.00027777777999999997, -0.00027777777999999997)

# DEM Topo over Bath # boooooo service is broken
orig(91.9976220703125165, -60.0024389648437548, 171.997622070310655, -8.00243896484496453,
     0.00249999999999994194, -0.00249999999999994194)

# 25m lidar
orig(113.76023194201119, -43.996225096314618, 156.7806037200736, -9.2055912338565218,
     0.00023999002436732555 , -0.00023999002436732563)

# 5m lidar
orig(113.76023292500008, -45.949852453747006, 162.00003317680361, -9.2055683139999545,
     4.4915764205976067e-005, -4.4915764205976074e-005)

# Aspect
orig(112.9995833333, -44.000416667025156,154.00013888951744, -9.9998611109207118,
     0.00027777777778226209 , -0.00027777777778226209)

# Slope
orig(112.9995833333, -44.000416667025156, 154.00013888951744, -9.9998611109207118,
     0.00027777777778226209 , -0.00027777777778226209)

# aus basemap 500m
orig(36.999999999999829, -90.000000000000114, 177.49999999999994, -6.0000000000000568,
     0.0041666666666666701, -0.0041666666666666692)

# Topo NATMAP 250m
orig(112.88336000000004, -43.999919999999932,154.00015999999991, -8.9999200000000386,
     0.000319999999999999, -0.00031999999999999905)


