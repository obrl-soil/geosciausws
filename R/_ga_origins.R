# calc raster::origin for GA products
options(digits = 22)
# formula adapted from https://github.com/rspatial/raster/blob/master/R/origin.R
orig <- function(xmin = NULL, ymin = NULL, xmax = NULL, ymax = NULL,
                 cell_x = NULL, cell_y = NULL) {
  e <- c('xmin' = xmin, 'ymin' = ymin, 'xmax' = xmax,'ymax' = ymax)

  r <- abs(c(cell_x, cell_y))

  x <- e['xmin'] - r[1]*(round(e['xmin'] / r[1]))
  y <- e['ymax'] - r[2]*(round(e['ymax'] / r[2]))

  if (isTRUE(all.equal((r[1] + x), abs(x)))) {
    x <- abs(x)
  }
  if (isTRUE(all.equal((r[2] + y), abs(y)))) {
    y <- abs(y)
  }
  return(c(x, y))
}

# SRTM_DEM 1"
orig(112.99986111400005, -44.0001389004617, 153.99986111335099, -10.00013890099995,
     0.00027777777777338031 , -0.00027777777777338031)

# SRTM DEMH 1"
orig(112.99986111100009, -44.000138889548303, 153.9998611116614, -10.000138888999906,
     0.00027777777778225824, -0.00027777777778225813)

# DEM_SRTM_1Second_over_Bathymetry_Topography_1
orig(91.997360943325319, -60.002824466238778, 171.99763936110531, -8.0022684946787805,
     0.00027777777999999997, -0.00027777777999999997)

# DEM Topo over Bath # boooooo service is broken
orig(91.9976220703125165, -60.0024389648437548, 171.997622070310655, -8.00243896484496453,
     0.00249999999999994194, -0.00249999999999994194)

# 25m lidar
orig(113.76023194201119, -43.996225096314618, 156.7806037200736, -9.2055912338565218,
     0.00023999002436732555 , -0.00023999002436732563)

# 5m lidar
orig(113.76023292500008, -45.949852453747006, 162.00003317680361, -9.2055683139999545,
     4.4915764205976067e-005, -4.4915764205976074e-005)

# Aspect
orig(112.9995833333, -44.000416667025156,154.00013888951744, -9.9998611109207118,
     0.00027777777778226209 , -0.00027777777778226209)

# Slope
orig(112.9995833333, -44.000416667025156, 154.00013888951744, -9.9998611109207118,
     0.00027777777778226209 , -0.00027777777778226209)

# aus basemap 500m layers 1 and 2
orig(36.999999999999829, -90.000000000000114, 177.49999999999994, -6.0000000000000568,
     0.0041666666666666701, -0.0041666666666666692)

# aus basemap 500m layer 3
orig(36.999999999912887, -89.999999999927979, 177.50416666652333, -5.9999999999615738,
     0.0041666666666649995, -0.0041666666666650004)

# Topo NATMAP 250m all
orig(112.88336000000004, -43.999919999999932,154.00015999999991, -8.9999200000000386,
     0.000319999999999999, -0.00031999999999999905)

# topo NATMAP Zone 49
orig(112.83541705009769, -29.022044129373381, 114.69428614392449, -21.57675537257418,
     0.00028859945564769406, -0.00028859945564769363)

# topo NATMAP Zone 50
orig(112.937768283946, -35.243206411137244, 120.84327445064481, -19.500407285861485,
     0.0002890390174654972, -0.00028903901746549698)

# topo NATMAP Zone 51
orig(119.08328729311187, -34.485678365543073, 126.91690453584506, -13.528249947575864,
     0.00028761996044695246, -0.00028761996044695268)

# topo NATMAP Zone 52
orig(125.17592837655015, -32.392971412581318, 132.82422422328, -11.036517059095111,
     0.00028420704718255926, -0.00028420704718255894)

# topo NATMAP Zone 53
orig(131.09924388775133, -36.433113792082437, 139.01199806233561, -10.94622776882979,
     0.0002910491843375245, -0.00029104918433752412)

# topo NATMAP Zone 54
orig(137.00868705528842, -40.218502521278651, 145.08487052584266, -8.9425913309250173,
     0.00029864229081663429, -0.00029864229081663402)

# topo NATMAP Zone 55
orig(142.77379501269701, -43.874979294817379, 150.9784722788807, -9.0335232282367439,
     0.00030726826702807633, -0.0003072682670280766)

# topo NATMAP Zone 56
orig(149.13142738567436, -38.001474096689194, 154.138797231111, -19.81251125861273,
     0.00029415319540836762, -0.00029415319540836843)

# 3" hillshade
orig(112.9998611111, -44.000129688873692, 153.9998447110998, -10.000143288873865,
     0.00083333299999999578, -0.00083333299999999578)

# landsat '06
orig(112.92136999914302, -43.742980000298594, 153.63836999914301, -8.9334800002986192,
     0.00049999999999999979, -0.00049999999999999958)

# global lo res bath
orig(-179.99999999999997, -89.999999999982009, 179.99999999996405, 90,
     0.033333333333330002, -0.033333333333330002)
